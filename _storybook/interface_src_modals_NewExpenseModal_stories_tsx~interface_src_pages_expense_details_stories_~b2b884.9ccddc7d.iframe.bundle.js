(self.webpackChunk_monetr_stories=self.webpackChunk_monetr_stories||[]).push([["interface_src_modals_NewExpenseModal_stories_tsx~interface_src_pages_expense_details_stories_~b2b884"],{"../interface/src/components/MSelectFunding.tsx":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return c}});var a=t("../node_modules/react/jsx-runtime.js");t("../node_modules/react/index.js");var s=t("../node_modules/@mui/icons-material/esm/index.js"),r=t("../node_modules/formik/dist/formik.esm.js"),l=t("../interface/src/components/MButton.tsx"),o=t.ir(t("../interface/src/components/MLabel.tsx")),d=t.ir(t("../interface/src/components/MSelect.tsx")),u=t("../interface/src/hooks/fundingSchedules.ts"),i=t("../interface/src/modals/NewFundingModal.tsx");function c(e){let n=(0,r.useFormikContext)(),{data:t,isLoading:c,isError:m}=(0,u.useFundingSchedulesSink)(),f=e.label??"Select a funding schedule";if(c)return(0,a.jsx)(d.default,{className:e?.className,disabled:!0,isLoading:!0,label:f,menuPortalTarget:e.menuPortalTarget,placeholder:"Select a funding schedule...",required:e?.required});if(m)return(0,a.jsx)(d.default,{className:e?.className,disabled:!0,isLoading:!0,label:f,menuPortalTarget:e.menuPortalTarget,placeholder:"Failed to load funding schedules...",required:e?.required});if(0===t.length)return(0,a.jsxs)("div",{className:"h-[84px] w-full",children:[(0,a.jsx)(o.default,{label:e.label,required:e.required}),(0,a.jsxs)(l.MBaseButton,{color:"primary",variant:"solid",className:"w-full h-[38px] font-normal text-start justify-start gap-2",onClick:function(){(0,i.showNewFundingModal)().then(t=>n.setFieldValue(e.name,t.fundingScheduleId))},children:[(0,a.jsx)(s.TodayOutlined,{}),"Create a new funding schedule..."]})]});let x=Array.from(t.values()).map(e=>({label:e.name,value:e.fundingScheduleId})),p=x.find(t=>t.value===n.values[e.name]);return(0,a.jsx)(d.default,{label:"When do you want to fund the expense?",menuPlacement:"auto",menuPortalTarget:e.menuPortalTarget,menuPosition:"fixed",name:"fundingScheduleId",onChange:function(t){n.setFieldValue(e.name,t.value)},options:x,placeholder:"Select a funding schedule...",required:e.required,value:p,className:e.className})}},"../interface/src/modals/NewExpenseModal.tsx":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});!function(e,n){for(var t in n)Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}(n,{default:function(){return _},showNewExpenseModal:function(){return v}});var a=t("../node_modules/react/jsx-runtime.js"),s=t("../node_modules/react/index.js"),r=t.ir(t("../node_modules/@ebay/nice-modal-react/lib/esm/index.js")),l=t("../node_modules/notistack/notistack.esm.js"),o=t.ir(t("../interface/src/components/MAmountField.tsx")),d=t.ir(t("../interface/src/components/MButton.tsx")),u=t.ir(t("../interface/src/components/MDatePicker.tsx")),i=t.ir(t("../interface/src/components/MForm.tsx")),c=t.ir(t("../interface/src/components/MModal.tsx")),m=t.ir(t("../interface/src/components/MSelectFrequency.tsx")),f=t.ir(t("../interface/src/components/MSelectFunding.tsx")),x=t.ir(t("../interface/src/components/MSpan.tsx")),p=t.ir(t("../interface/src/components/MTextField.tsx")),h=t("../node_modules/date-fns/esm/index.js"),g=t("../interface/src/hooks/bankAccounts.ts"),b=t("../interface/src/hooks/spending.ts"),j=t.ir(t("../interface/src/models/Spending.ts")),w=t("../interface/src/util/amounts.ts");let S={name:"",amount:0,nextOccurrence:(0,h.startOfTomorrow)(),ruleset:"",fundingScheduleId:0},y=r.default.create(function(){let e=(0,r.useModal)(),{enqueueSnackbar:n}=(0,l.useSnackbar)(),t=(0,g.useSelectedBankAccountId)(),y=(0,b.useCreateSpending)(),_=(0,s.useRef)(null);async function v(a,s){let r=new j.default({bankAccountId:t,name:a.name.trim(),nextRecurrence:(0,h.startOfDay)(new Date(a.nextOccurrence)),spendingType:j.SpendingType.Expense,fundingScheduleId:a.fundingScheduleId,targetAmount:(0,w.friendlyToAmount)(a.amount),ruleset:a.ruleset});return s.setSubmitting(!0),y(r).then(n=>e.resolve(n)).then(()=>e.remove()).catch(e=>void n(e.response.data.error,{variant:"error",disableWindowBlurListener:!0})).finally(()=>s.setSubmitting(!1))}return(0,a.jsx)(c.default,{open:e.visible,ref:_,className:"sm:max-w-xl",children:(0,a.jsxs)(i.default,{onSubmit:v,initialValues:S,className:"h-full flex flex-col gap-2 p-2 justify-between","data-testid":"new-expense-modal",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(x.default,{className:"font-bold text-xl mb-2",children:"Create A New Expense"}),(0,a.jsx)(p.default,{id:"expense-name-search",name:"name",label:"What are you budgeting for?",required:!0,autoComplete:"off",placeholder:"Amazon, Netflix..."}),(0,a.jsxs)("div",{className:"flex gap-0 md:gap-4 flex-col md:flex-row",children:[(0,a.jsx)(o.default,{name:"amount",label:"How much do you need?",required:!0,className:"w-full md:w-1/2",allowNegative:!1}),(0,a.jsx)(u.default,{className:"w-full md:w-1/2",label:"When do you need it next?",min:(0,h.startOfTomorrow)(),name:"nextOccurrence",required:!0})]}),(0,a.jsx)(f.default,{menuPortalTarget:document.body,label:"When do you want to fund the expense?",required:!0,name:"fundingScheduleId"}),(0,a.jsx)(m.default,{dateFrom:"nextOccurrence",menuPosition:"fixed",menuShouldScrollIntoView:!1,menuShouldBlockScroll:!0,menuPortalTarget:document.body,menuPlacement:"bottom",label:"How frequently do you need this expense?",placeholder:"Select a spending frequency...",required:!0,name:"ruleset"})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(d.default,{color:"cancel",onClick:e.remove,"data-testid":"close-new-expense-modal",children:"Cancel"}),(0,a.jsx)(d.default,{color:"primary",type:"submit",children:"Create"})]})]})})});var _=y;function v(){return r.default.show(y)}}}]);
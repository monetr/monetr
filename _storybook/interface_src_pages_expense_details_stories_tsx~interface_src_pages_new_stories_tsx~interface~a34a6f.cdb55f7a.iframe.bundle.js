(self.webpackChunk_monetr_stories=self.webpackChunk_monetr_stories||[]).push([["interface_src_pages_expense_details_stories_tsx~interface_src_pages_new_stories_tsx~interface~a34a6f"],{"../interface/src/components/MSpinner.tsx":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}});var l=n("../node_modules/react/jsx-runtime.js");n("../node_modules/react/index.js");var a=n.ir(n("../interface/src/util/mergeTailwind.ts"));function r(e){let t=(0,a.default)("h-12","w-12",e.className,"animate-spin");return(0,l.jsx)("div",{"aria-label":"Loading...",role:"status",children:(0,l.jsxs)("svg",{className:t,viewBox:"3 3 18 18",children:[(0,l.jsx)("path",{className:"fill-dark-monetr-background-subtle",d:"M12 5C8.13401 5 5 8.13401 5 12C5 15.866 8.13401 19 12 19C15.866 19 19 15.866 19 12C19 8.13401 15.866 5 12 5ZM3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12Z"}),(0,l.jsx)("path",{className:"fill-dark-monetr-brand",d:"M16.9497 7.05015C14.2161 4.31648 9.78392 4.31648 7.05025 7.05015C6.65973 7.44067 6.02656 7.44067 5.63604 7.05015C5.24551 6.65962 5.24551 6.02646 5.63604 5.63593C9.15076 2.12121 14.8492 2.12121 18.364 5.63593C18.7545 6.02646 18.7545 6.65962 18.364 7.05015C17.9734 7.44067 17.3403 7.44067 16.9497 7.05015Z"})]})})}},"../interface/src/pages/setup.tsx":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return g}});var l=n("../node_modules/react/jsx-runtime.js"),a=n.ir(n("../node_modules/react/index.js")),r=n("../node_modules/react-plaid-link/dist/index.umd.js"),s=n("../node_modules/react-router-dom/dist/index.js"),i=n("../node_modules/@mui/icons-material/esm/index.js"),o=n.ir(n("../node_modules/@sentry/react/esm/index.js")),d=n("../node_modules/@tanstack/react-query/build/lib/index.mjs"),c=n("../interface/src/components/MButton.tsx"),u=n.ir(n("../interface/src/components/MLink.tsx")),m=n.ir(n("../interface/src/components/MLogo.tsx")),f=n.ir(n("../interface/src/components/MSpan.tsx")),x=n.ir(n("../interface/src/components/MSpinner.tsx")),h=n("../interface/src/hooks/useAppConfiguration.ts"),p=n.ir(n("../interface/src/util/mergeTailwind.ts")),j=n.ir(n("../interface/src/util/request.ts"));function g(e){let[t,n]=(0,a.useState)("greeting");switch(t){case"greeting":return(0,l.jsx)(b,{onContinue:n,manualEnabled:e.manualEnabled,alreadyOnboarded:e.alreadyOnboarded});case"plaid":return(0,l.jsx)(y,{alreadyOnboarded:e.alreadyOnboarded});case"manual":return(0,l.jsx)(s.Navigate,{to:"/setup/manual"});default:return(0,l.jsx)("h1",{children:"Something went wrong..."})}}function b(e){let t=(0,h.useAppConfiguration)(),[n,r]=(0,a.useState)(null);return(0,l.jsxs)("div",{className:"w-full h-full flex lg:justify-center items-center gap-4 md:gap-8 flex-col overflow-y-auto py-4",children:[(0,l.jsx)(m.default,{className:"w-16 h-16 md:w-24 md:h-24"}),(0,l.jsx)(function(){return e.alreadyOnboarded?(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center text-center",children:[(0,l.jsx)(f.default,{className:"text-2xl font-medium",children:"Adding another bank?"}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"Please select what type of bank you want to setup below."})]}):(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center text-center",children:[(0,l.jsx)(f.default,{size:"2xl",weight:"medium",children:"Welcome to monetr!"}),(0,l.jsx)(f.default,{size:"lg",color:"subtle",children:"Before we get started, please select how you would like to continue."})]})},{}),(0,l.jsxs)("div",{className:"flex gap-4 flex-col md:flex-row p-2",children:[(0,l.jsx)(k,{icon:(0,l.jsx)(i.LinkOutlined,{}),name:"Connected",description:"Connect to your bank account automatically using Plaid.",active:"plaid"===n,onClick:()=>r("plaid"),disabled:!t?.plaidEnabled}),(0,l.jsx)(k,{icon:(0,l.jsx)(i.EditOutlined,{}),name:"Manual",description:"Enter transaction and balance data manually.",active:"manual"===n,onClick:()=>r("manual"),comingSoon:!e.manualEnabled})]}),(0,l.jsx)(c.MBaseButton,{color:n?"primary":"secondary",disabled:!n,onClick:()=>e.onContinue(n),children:"Continue"}),(0,l.jsx)(function(){return e.alreadyOnboarded?null:(0,l.jsxs)("div",{className:"flex justify-center gap-1",children:[(0,l.jsx)(f.default,{color:"subtle",className:"text-sm",children:"Not ready to continue?"}),(0,l.jsx)(u.default,{to:"/logout",size:"sm",children:"Logout for now"})]})},{})]})}function k(e){let t=(0,p.default)({"dark:border-dark-monetr-brand":e.active,"dark:hover:border-dark-monetr-brand-subtle":e.active,"border-monetr-brand":e.active,"hover:border-monetr-brand-subtle":e.active},{"dark:border-dark-monetr-border":!e.active,"dark:hover:border-dark-monetr-border-string":!e.active,"border-monetr-border":!e.active,"hover:border-monetr-border-string":!e.active},"cursor-pointer","border"),n=(0,p.default)("cursor-not-allowed","dark:ring-dark-monetr-border-subtle","ring-monetr-border-subtle","ring-1","ring-inset","dark:text-dark-monetr-content-muted","text-monetr-content-muted","opacity-50"),r=e.comingSoon||e.disabled,s=(0,p.default)({[t]:!r},{[n]:r},"text-center","flex","flex-row","md:flex-col","gap-4","group","md:h-72","md:w-56","items-center","p-2","py-4","md:p-4","relative","rounded-lg");return(0,l.jsxs)("a",{className:s,onClick:function(){!e.comingSoon&&e.onClick()},children:[e.active&&(0,l.jsx)(i.CheckCircle,{className:"absolute dark:text-dark-monetr-brand-subtle top-2 right-2"}),a.default.cloneElement(e.icon,{className:"w-10 h-10 md:w-16 md:h-16 ml-4 md:ml-0 md:mt-2"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 items-center h-full md:mt-4 text-center w-full md:w-auto",children:[(0,l.jsx)(f.default,{className:"text-lg font-medium",children:e.name}),(0,l.jsx)(f.default,{color:"subtle",children:e.description}),!e.comingSoon&&(0,l.jsx)(f.default,{children:"\xa0"}),e.comingSoon&&(0,l.jsx)(f.default,{className:"md:mt-5 font-medium",children:"Coming Soon"}),e.disabled&&(0,l.jsx)(f.default,{className:"md:mt-5 font-medium",children:"Unavailable"})]})]})}function y(e){let[{token:t,loading:n,error:i,exited:c,settingUp:u},h]=(0,a.useState)({error:null,exited:!1,loading:!1,settingUp:!1,token:null}),p=(0,d.useQueryClient)(),g=(0,s.useNavigate)();async function b(e,l){if(h({token:t,loading:n,error:i,exited:c,settingUp:!0}),e>6)return Promise.resolve();(0,j.default)().get(`/plaid/link/setup/wait/${l}`).catch(t=>{if(408===t.response.status)return b(e+1,l);throw t})}async function k(e,n){return(0,j.default)().post("/plaid/link/token/callback",{publicToken:e,institutionId:n.institution.institution_id,institutionName:n.institution.name,accountIds:n.accounts.map(e=>e.id)}).then(async e=>{let t=e.data.linkId;await b(0,t),setTimeout(()=>{p.invalidateQueries(["/links"]),p.invalidateQueries(["/bank_accounts"]),g("/")},8e3)}).catch(e=>{h({token:t,error:e,loading:!1,settingUp:!1})})}let{error:y,open:w}=(0,r.usePlaidLink)({token:t,onSuccess:k,onExit:function(e,l){e?(console.warn("Plaid link exited with error",{"plaid.request_id":l.request_id,"plaid.link_session_id":l.link_session_id,data:e}),o.captureEvent({message:"Plaid link exited with error",level:o.Severity.Error,tags:{"plaid.request_id":l.request_id,"plaid.link_session_id":l.link_session_id},breadcrumbs:[{type:"info",level:o.Severity.Info,message:"Error from Plaid link",data:e}]}),h({token:t,loading:n,exited:c,error:"Plaid link exited with an error."})):h({token:t,loading:n,exited:!0})},onLoad:null,onEvent:null});(0,a.useEffect)(()=>{(0,j.default)().get("/plaid/link/token/new?use_cache=true").then(e=>setTimeout(()=>{h({loading:!1,token:e.data.linkToken,error:null})},1e3)).catch(e=>setTimeout(()=>{let t=e?.response?.data?.error||"Could not connect to Plaid, an unknown error occurred.";h({loading:!1,token:null,error:t})},3e3))},[]),(0,a.useEffect)(()=>{t&&w&&(w(),h({token:t,loading:!0}))},[t,w]),(0,a.useEffect)(()=>{y&&o.captureException(y)},[y]);let N=(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,l.jsx)(f.default,{className:"text-2xl font-medium",children:"Getting Plaid Ready!"}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"One moment while we prepare your connection with Plaid."})]});return u&&(N=(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,l.jsx)(f.default,{className:"text-2xl font-medium",children:"Successfully connected with Plaid!"}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"Hold on a moment while we pull the initial data from Plaid into monetr."})]})),n&&(N=(0,l.jsx)("div",{className:"flex flex-col justify-center items-center",children:(0,l.jsx)(x.default,{})})),i&&(N=(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,l.jsx)(f.default,{className:"text-2xl font-medium",children:"Something isn't quite right"}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"We were not able to get Plaid ready for you at this time, please try again shortly."}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"If the problem continues, please contact support@monetr.app"}),(0,l.jsxs)(f.default,{className:"text-md",color:"muted",children:["Error Message: ",i]})]})),c&&(N=(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,l.jsx)(f.default,{className:"text-2xl font-medium",children:"Something isn't quite right"}),(0,l.jsx)(f.default,{className:"text-lg",color:"subtle",children:"Plaid exited, did you want to set it up later?"})]})),(0,l.jsxs)("div",{className:"w-full h-full flex justify-center items-center gap-8 flex-col overflow-hidden text-center p-2",children:[(0,l.jsx)(m.default,{className:"w-24 h-24"}),N,(0,l.jsx)(function(){return e.alreadyOnboarded?null:(0,l.jsx)(v,{})},{})]})}function v(){return(0,l.jsxs)("div",{className:"flex justify-center gap-1",children:[(0,l.jsx)(f.default,{color:"subtle",className:"text-sm",children:"Not ready to continue?"}),(0,l.jsx)(u.default,{to:"/logout",size:"sm",children:"Logout for now"})]})}}}]);